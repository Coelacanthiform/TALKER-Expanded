# TALKER Expanded
A fork of [TALKER](https://github.com/danclave/TALKER). See the main repo for full installation instructions and setup guide.

This is my personal experiment attempting to get more immersion and roleplaying out of the already amazing TALKER mod.

I am an absolute hack, and all credit for this amazing mod goes to the creators and maintainers of the main repo. Credit to [this](https://github.com/danclave/TALKER/issues/39) and the discussion in that thread for setting me down on the road to fiddling with the prompt. I still use many of the ideas from that discussion in my current prompt. Credit to [issue#40](https://github.com/danclave/TALKER/issues/40) of the main repo for the basic code for reloading personalities on existing save games. Credit also to that same user again ([CanineHatTrickOnNose](https://github.com/CanineHatTrickOnNose)) for doing the initial revision of faction personalities and unique character personalities. I initially used his files from Discord with base TALKER, and looking at those files and making changes was how I started this mod. Some of his characterisations are still in the files wholesale alongside my additions as they fit the character well.

## CHANGES FROM MAIN BUILD

*   **Backstories:** The biggest fundamental change I've made is introducing Backstories. This is a new part of character identity that supplements the already existing personality, giving the LLM more information about characterization and making every NPC more unique and different from the next. Unique characters have unique backstories based on lore and information about the character in the game, from previous games and/or on the wiki. Each non-unique NPC is given a random backstory from a list of over 100+ depending on the faction. The backstories are still in a process of revision, but the goal is for every faction to have their own unique flavour and have random NPCs with backstories that make sense for their faction identity.

*   **Expanded random NPC character personality:** I have tried to revise the personality trait list, making sure the personality traits are interesting and lead to good output. I have also expanded the list from the default 63 to over 200, hopefully providing some more variety. Finally, the script now assigns *two* random personalitity traits to every NPC instead of one. I have found two personality traits to be the ideal number, as they can play off each other and combine into a distinct characterization without confusing the LLM. This - combined with a random backstory - will hopefully make every random NPC feel unique and distinctive.

*   **Better prompting and immersion:** The prompt sent to the AI in TALKER is very basic, and the LLM is given very little information to work with both in general, in relation to the speaking character and in relation to the surrounding world. I have played around with expanding and revising the general prompt, as well as made changes to the dynamic prompt generator and the information stored in memory for every event. The general rules in config.lua are much more extensive now, with a focus on trying to make the output lifelike and make the NPCs talk like independent human beings. It also has guidelines for ranks and what they mean, and the dynamic part of the prompt now provides more faction and rank context. Unlike base TALKER, NPCs now know which faction they belong to and which factions you and others around them belong to. NPCs will act according to their rank, and will treat you differently depending on your rank. You will be called a "rookie" if you are one for example, and treated with less respect. NPCs that are your companions should know that they are companions, and behave a little more friendly towards you. NPCs with fixed roles like mechanics and bartenders are fed this information in the prompt so they can act naturally according to their role, offering you a drink or talking about repairs.

*  **Script fixes:** Idle Conversation and Artifact script now both work. Callout script has an anti-spam function to prevent repeated callouts on the same object. Anomalies script filters out radioactive fields and radiation anomalies, preventing the behaviour in base TALKER of NPCs constantly talking about how irradiated you are and making jokes about you "glowing in the dark".


## EXISTING SAVES/RELOADING PERSONALITIES AND BACKGROUNDS
If you have an ongoing save, or you want to reset randomly generated personalities or backstories you can go to TALKER\bin\lua\domain\repo and in personalites.lua/backstories.lua you can change RESET_PERSONALITIES_ON_LOAD/RESET_BACKSTORIES_ON_LOAD from "false" to "true". After loading your save, save again. Then exit and change it back to "false". If you have non-unique companions you can reload multiple times until you get a backstory+personality combination you're happy with. You can see their personalities and backstory printed in the console after a reply, or just run the TALKER proxy with detailed logging.


## NOTES
I have not tested my changes over a full playthrough. It's possible some backstories are too prescriptive and specific for NPCs that are your companions, leading to monotonous responses. Feedback and testing is needed.

Different LLMs will provide different output. Not all models are equally good for dialogue and roleplay. I've had the following models give good output in testing:

Google's Gemini 2.5 - Fast, great at following prompt instructions, gives generally good responses. Unfortunately Google reduces the rate limits recently so you might have trouble hitting your quotas fast unless you already had a bunch of pre-existing verified accounts (or accounts made from before verification was needed).

Nvidia's mistral-large-3-675b-instruct-2512 - Slightly more expressive than Gemini, but more or less of similar quality. Works great, also recommended.

Nvidia's Kimi-K2-Instruct-0905 - Produces great dialogue, but sometimes plays a little fast-and-loose with the rules in the prompt. It likes describing what the character is doing physically despite being explicitly told not to and can produce a little too long and wordy replies despite being told to keep it brief. I still enjoy the writing it produces but it's not perfect.
